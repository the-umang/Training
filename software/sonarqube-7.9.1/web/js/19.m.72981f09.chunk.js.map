{"version":3,"sources":["webpack:///./src/main/js/apps/permissions/global/components/PageHeader.tsx","webpack:///./src/main/js/apps/permissions/global/components/AllHoldersList.tsx","webpack:///./src/main/js/apps/permissions/global/components/App.tsx","webpack:///./src/main/js/components/controls/HelpTooltip.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/components/controls/HelpTooltip.css?558a","webpack:///./src/main/js/components/controls/HelpTooltip.css","webpack:///./src/main/js/components/controls/ListFooter.tsx"],"names":["PageHeader_PageHeader","index_js_exposed","[object Object]","title","this","props","organization","Object","l10n","description","className","loading","components_AllHoldersList","es","state","appState","rootReducer","handleToggleUser","user","permission","permissions","includes","revokePermissionFromUser","login","grantPermissionToUser","handleToggleGroup","group","revokePermissionFromGroup","name","grantPermissionToGroup","_this$props","filter","groups","groupsPaging","users","usersPaging","l10nPrefix","governanceInstalled","qualifiers","utils","count","total","length","HoldersList","onToggleGroup","onToggleUser","query","SearchForm","onFilter","onSearch","ListFooter","loadMore","onLoadMore","App_App","super","mounted","loadUsersAndGroups","userPage","groupsPage","_this$state","getUsers","api_permissions","q","undefined","key","p","Promise","resolve","paging","getGroups","all","loadHolders","setState","then","_ref","_ref2","_slicedToArray","usersResponse","groupsResponse","stopLoading","_this$state2","pageIndex","_ref3","_ref4","_ref5","addPermissionToGroup","map","candidate","assign","addPermissionToUser","removePermissionFromGroup","without_default","removePermissionFromUser","_ref6","groupName","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","Suggestions","suggestions","Helmet_default","a","__webpack_require__","d","__webpack_exports__","HelpTooltip","react__WEBPACK_IMPORTED_MODULE_0__","classnames__WEBPACK_IMPORTED_MODULE_1__","_Tooltip__WEBPACK_IMPORTED_MODULE_2__","_icons_components_HelpIcon__WEBPACK_IMPORTED_MODULE_3__","_app_theme__WEBPACK_IMPORTED_MODULE_4__","_props$children","children","fill","size","_props$tagName","tagName","mouseLeaveDelay","onShow","overlay","placement","_SuggestionsContext__WEBPACK_IMPORTED_MODULE_1__","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","prevProps","content","module","i","options","hmr","transform","insertInto","locals","exports","push","_a","_a$ready","ready","__rest","hasMore","loadMoreLink","href","onClick","event","preventDefault","currentTarget","blur","_helpers_l10n__WEBPACK_IMPORTED_MODULE_3__","reloadLink","reload","new-loading","link","needReload","_helpers_measures__WEBPACK_IMPORTED_MODULE_4__","_common_DeferredSpinner__WEBPACK_IMPORTED_MODULE_2__"],"mappings":"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","file":"js/19.m.72981f09.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from '../../../../helpers/l10n';\n\ninterface Props {\n  loading?: boolean;\n  organization?: {};\n}\n\nexport default class PageHeader extends React.PureComponent<Props> {\n  render() {\n    const title = this.props.organization\n      ? translate('permissions.page')\n      : translate('global_permissions.page');\n\n    const description = this.props.organization\n      ? translate('organization_permissions.page.description')\n      : translate('global_permissions.page.description');\n\n    return (\n      <header className=\"page-header\">\n        <h1 className=\"page-title\">{title}</h1>\n\n        {this.props.loading && <i className=\"spinner\" />}\n\n        <div className=\"page-description\">{description}</div>\n      </header>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport SearchForm from '../../shared/components/SearchForm';\nimport HoldersList from '../../shared/components/HoldersList';\nimport ListFooter from '../../../../components/controls/ListFooter';\nimport {\n  PERMISSIONS_ORDER_GLOBAL,\n  convertToPermissionDefinitions,\n  PERMISSIONS_ORDER_GLOBAL_GOV\n} from '../../utils';\nimport { Store, getAppState } from '../../../../store/rootReducer';\n\ninterface StateProps {\n  appState: Pick<T.AppState, 'qualifiers'>;\n}\n\ninterface OwnProps {\n  filter: string;\n  grantPermissionToGroup: (groupName: string, permission: string) => Promise<void>;\n  grantPermissionToUser: (login: string, permission: string) => Promise<void>;\n  groups: T.PermissionGroup[];\n  groupsPaging?: T.Paging;\n  loadHolders: () => void;\n  loading?: boolean;\n  onLoadMore: () => void;\n  onFilter: (filter: string) => void;\n  onSearch: (query: string) => void;\n  organization?: T.Organization;\n  query: string;\n  revokePermissionFromGroup: (groupName: string, permission: string) => Promise<void>;\n  revokePermissionFromUser: (login: string, permission: string) => Promise<void>;\n  users: T.PermissionUser[];\n  usersPaging?: T.Paging;\n}\n\ntype Props = StateProps & OwnProps;\n\nexport class AllHoldersList extends React.PureComponent<Props> {\n  handleToggleUser = (user: T.PermissionUser, permission: string) => {\n    const hasPermission = user.permissions.includes(permission);\n    if (hasPermission) {\n      return this.props.revokePermissionFromUser(user.login, permission);\n    } else {\n      return this.props.grantPermissionToUser(user.login, permission);\n    }\n  };\n\n  handleToggleGroup = (group: T.PermissionGroup, permission: string) => {\n    const hasPermission = group.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromGroup(group.name, permission);\n    } else {\n      return this.props.grantPermissionToGroup(group.name, permission);\n    }\n  };\n\n  render() {\n    const { filter, groups, groupsPaging, users, usersPaging } = this.props;\n    const l10nPrefix = this.props.organization ? 'organizations_permissions' : 'global_permissions';\n    const governanceInstalled = this.props.appState.qualifiers.includes('VW');\n    const permissions = convertToPermissionDefinitions(\n      governanceInstalled ? PERMISSIONS_ORDER_GLOBAL_GOV : PERMISSIONS_ORDER_GLOBAL,\n      l10nPrefix\n    );\n\n    let count = 0;\n    let total = 0;\n    if (filter !== 'users') {\n      count += groups.length;\n      total += groupsPaging ? groupsPaging.total : groups.length;\n    }\n    if (filter !== 'groups') {\n      count += users.length;\n      total += usersPaging ? usersPaging.total : users.length;\n    }\n\n    return (\n      <>\n        <HoldersList\n          filter={this.props.filter}\n          groups={this.props.groups}\n          loading={this.props.loading}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          query={this.props.query}\n          users={this.props.users}>\n          <SearchForm\n            filter={this.props.filter}\n            onFilter={this.props.onFilter}\n            onSearch={this.props.onSearch}\n            query={this.props.query}\n          />\n        </HoldersList>\n        <ListFooter count={count} loadMore={this.props.onLoadMore} total={total} />\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store): StateProps => ({\n  appState: getAppState(state)\n});\n\nexport default connect(mapStateToProps)(AllHoldersList);\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport { without } from 'lodash';\nimport PageHeader from './PageHeader';\nimport AllHoldersList from './AllHoldersList';\nimport * as api from '../../../../api/permissions';\nimport Suggestions from '../../../../app/components/embed-docs-modal/Suggestions';\nimport { translate } from '../../../../helpers/l10n';\nimport '../../styles.css';\n\ninterface Props {\n  organization?: T.Organization;\n}\n\ninterface State {\n  filter: 'all' | 'groups' | 'users';\n  groups: T.PermissionGroup[];\n  groupsPaging?: T.Paging;\n  loading: boolean;\n  query: string;\n  users: T.PermissionUser[];\n  usersPaging?: T.Paging;\n}\n\nexport default class App extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      filter: 'all',\n      groups: [],\n      loading: true,\n      query: '',\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadUsersAndGroups = (userPage?: number, groupsPage?: number) => {\n    const { organization } = this.props;\n    const { filter, query } = this.state;\n\n    const getUsers: Promise<{ paging?: T.Paging; users: T.PermissionUser[] }> =\n      filter !== 'groups'\n        ? api.getGlobalPermissionsUsers({\n            q: query || undefined,\n            organization: organization && organization.key,\n            p: userPage\n          })\n        : Promise.resolve({ paging: undefined, users: [] });\n\n    const getGroups: Promise<{ paging?: T.Paging; groups: T.PermissionGroup[] }> =\n      filter !== 'users'\n        ? api.getGlobalPermissionsGroups({\n            q: query || undefined,\n            organization: organization && organization.key,\n            p: groupsPage\n          })\n        : Promise.resolve({ paging: undefined, groups: [] });\n\n    return Promise.all([getUsers, getGroups]);\n  };\n\n  loadHolders = () => {\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups().then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState({\n          groups: groupsResponse.groups,\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: usersResponse.users,\n          usersPaging: usersResponse.paging\n        });\n      }\n    }, this.stopLoading);\n  };\n\n  onLoadMore = () => {\n    const { usersPaging, groupsPaging } = this.state;\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups(\n      usersPaging ? usersPaging.pageIndex + 1 : 1,\n      groupsPaging ? groupsPaging.pageIndex + 1 : 1\n    ).then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState(({ groups, users }) => ({\n          groups: [...groups, ...groupsResponse.groups],\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: [...users, ...usersResponse.users],\n          usersPaging: usersResponse.paging\n        }));\n      }\n    }, this.stopLoading);\n  };\n\n  onFilter = (filter: 'all' | 'groups' | 'users') => {\n    this.setState({ filter }, this.loadHolders);\n  };\n\n  onSearch = (query: string) => {\n    this.setState({ query }, this.loadHolders);\n  };\n\n  addPermissionToGroup = (groups: T.PermissionGroup[], group: string, permission: string) => {\n    return groups.map(candidate =>\n      candidate.name === group\n        ? { ...candidate, permissions: [...candidate.permissions, permission] }\n        : candidate\n    );\n  };\n\n  addPermissionToUser = (users: T.PermissionUser[], user: string, permission: string) => {\n    return users.map(candidate =>\n      candidate.login === user\n        ? { ...candidate, permissions: [...candidate.permissions, permission] }\n        : candidate\n    );\n  };\n\n  removePermissionFromGroup = (groups: T.PermissionGroup[], group: string, permission: string) => {\n    return groups.map(candidate =>\n      candidate.name === group\n        ? { ...candidate, permissions: without(candidate.permissions, permission) }\n        : candidate\n    );\n  };\n\n  removePermissionFromUser = (users: T.PermissionUser[], user: string, permission: string) => {\n    return users.map(candidate =>\n      candidate.login === user\n        ? { ...candidate, permissions: without(candidate.permissions, permission) }\n        : candidate\n    );\n  };\n\n  grantPermissionToGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ groups }) => ({\n        groups: this.addPermissionToGroup(groups, group, permission)\n      }));\n      return api\n        .grantPermissionToGroup({\n          groupName: group,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ groups }) => ({\n                groups: this.removePermissionFromGroup(groups, group, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  grantPermissionToUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ users }) => ({\n        users: this.addPermissionToUser(users, user, permission)\n      }));\n      return api\n        .grantPermissionToUser({\n          login: user,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ users }) => ({\n                users: this.removePermissionFromUser(users, user, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ groups }) => ({\n        groups: this.removePermissionFromGroup(groups, group, permission)\n      }));\n      return api\n        .revokePermissionFromGroup({\n          groupName: group,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ groups }) => ({\n                groups: this.addPermissionToGroup(groups, group, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ users }) => ({\n        users: this.removePermissionFromUser(users, user, permission)\n      }));\n      return api\n        .revokePermissionFromUser({\n          login: user,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ users }) => ({\n                users: this.addPermissionToUser(users, user, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"page page-limited\">\n        <Suggestions suggestions=\"global_permissions\" />\n        <Helmet title={translate('global_permissions.permission')} />\n        <PageHeader loading={this.state.loading} organization={this.props.organization} />\n        <AllHoldersList\n          filter={this.state.filter}\n          grantPermissionToGroup={this.grantPermissionToGroup}\n          grantPermissionToUser={this.grantPermissionToUser}\n          groups={this.state.groups}\n          groupsPaging={this.state.groupsPaging}\n          loadHolders={this.loadHolders}\n          loading={this.state.loading}\n          onFilter={this.onFilter}\n          onLoadMore={this.onLoadMore}\n          onSearch={this.onSearch}\n          query={this.state.query}\n          revokePermissionFromGroup={this.revokePermissionFromGroup}\n          revokePermissionFromUser={this.revokePermissionFromUser}\n          users={this.state.users}\n          usersPaging={this.state.usersPaging}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport Tooltip, { Placement } from './Tooltip';\nimport HelpIcon from '../icons-components/HelpIcon';\nimport * as theme from '../../app/theme';\nimport './HelpTooltip.css';\n\ninterface Props {\n  className?: string;\n  children?: React.ReactNode;\n  onShow?: () => void;\n  overlay: React.ReactNode;\n  placement?: Placement;\n  tagName?: string;\n}\n\nexport default function HelpTooltip(props: Props) {\n  const { children = <HelpIcon fill={theme.gray71} size={12} />, tagName = 'div' } = props;\n\n  return React.createElement(\n    tagName,\n    { className: classNames('help-tooltip', props.className) },\n    <Tooltip\n      mouseLeaveDelay={0.25}\n      onShow={props.onShow}\n      overlay={props.overlay}\n      placement={props.placement}>\n      <span className=\"display-inline-flex-center\">{children}</span>\n    </Tooltip>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./HelpTooltip.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./HelpTooltip.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./HelpTooltip.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".help-tooltip{display:inline-flex;align-items:center;vertical-align:middle}.help-toolip-link{display:block;width:12px;height:12px;border:none}\", \"\"]);\n\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport DeferredSpinner from '../common/DeferredSpinner';\nimport { translate, translateWithParameters } from '../../helpers/l10n';\nimport { formatMeasure } from '../../helpers/measures';\n\nexport interface Props {\n  count: number;\n  className?: string;\n  loading?: boolean;\n  loadMore?: () => void;\n  needReload?: boolean;\n  reload?: () => void;\n  ready?: boolean;\n  total?: number;\n}\n\nexport default function ListFooter({ ready = true, ...props }: Props) {\n  const handleLoadMore = (event: React.SyntheticEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (props.loadMore) {\n      props.loadMore();\n    }\n  };\n\n  const handleReload = (event: React.SyntheticEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (props.reload) {\n      props.reload();\n    }\n  };\n\n  const hasMore = props.total && props.total > props.count;\n\n  const loadMoreLink = (\n    <a className=\"spacer-left\" href=\"#\" onClick={handleLoadMore}>\n      {translate('show_more')}\n    </a>\n  );\n\n  const reloadLink = (\n    <a className=\"spacer-left\" href=\"#\" onClick={handleReload}>\n      {translate('reload')}\n    </a>\n  );\n\n  const className = classNames(\n    'spacer-top note text-center',\n    { 'new-loading': !ready },\n    props.className\n  );\n\n  let link;\n\n  if (props.needReload && props.reload) {\n    link = reloadLink;\n  } else if (hasMore && props.loadMore) {\n    link = loadMoreLink;\n  }\n\n  return (\n    <footer className={className}>\n      {translateWithParameters(\n        'x_of_y_shown',\n        formatMeasure(props.count, 'INT', null),\n        formatMeasure(props.total, 'INT', null)\n      )}\n      {link}\n      {props.loading && <DeferredSpinner className=\"text-bottom spacer-left position-absolute\" />}\n    </footer>\n  );\n}\n"],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1712:function(e,s,t){"use strict";t.r(s);var r=t(417),o=t.n(r),i=t(365),n=t(381),a=t.n(n),l=t(0);class p extends i.PureComponent{render(){const e=this.props.organization?Object(l.l)("permissions.page"):Object(l.l)("global_permissions.page"),s=this.props.organization?Object(l.l)("organization_permissions.page.description"):Object(l.l)("global_permissions.page.description");return i.createElement("header",{className:"page-header"},i.createElement("h1",{className:"page-title"},e),this.props.loading&&i.createElement("i",{className:"spinner"}),i.createElement("div",{className:"page-description"},s))}}var u=t(377),g=t(876),m=t(899),h=t(397),d=t(598),c=t(379);var v=Object(u.connect)(e=>({appState:Object(c.getAppState)(e)}))(class extends i.PureComponent{constructor(){super(...arguments),this.handleToggleUser=(e,s)=>e.permissions.includes(s)?this.props.revokePermissionFromUser(e.login,s):this.props.grantPermissionToUser(e.login,s),this.handleToggleGroup=(e,s)=>e.permissions.includes(s)?this.props.revokePermissionFromGroup(e.name,s):this.props.grantPermissionToGroup(e.name,s)}render(){const e=this.props,s=e.filter,t=e.groups,r=e.groupsPaging,o=e.users,n=e.usersPaging,a=this.props.organization?"organizations_permissions":"global_permissions",l=this.props.appState.qualifiers.includes("VW"),p=Object(d.e)(l?d.d:d.c,a);let u=0,c=0;return"users"!==s&&(u+=t.length,c+=r?r.total:t.length),"groups"!==s&&(u+=o.length,c+=n?n.total:o.length),i.createElement(i.Fragment,null,i.createElement(m.a,{filter:this.props.filter,groups:this.props.groups,loading:this.props.loading,onToggleGroup:this.handleToggleGroup,onToggleUser:this.handleToggleUser,permissions:p,query:this.props.query,users:this.props.users},i.createElement(g.a,{filter:this.props.filter,onFilter:this.props.onFilter,onSearch:this.props.onSearch,query:this.props.query})),i.createElement(h.a,{count:u,loadMore:this.props.onLoadMore,total:c}))}}),f=t(522),P=t(389);t(877);function y(e,s){return function(e){if(Array.isArray(e))return e}(e)||function(e,s){var t=[],r=!0,o=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(r=(n=a.next()).done)&&(t.push(n.value),!s||t.length!==s);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return t}(e,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.d(s,"default",function(){return b});class b extends i.PureComponent{constructor(e){super(e),this.mounted=!1,this.loadUsersAndGroups=(e,s)=>{const t=this.props.organization,r=this.state,o=r.filter,i=r.query,n="groups"!==o?f.i({q:i||void 0,organization:t&&t.key,p:e}):Promise.resolve({paging:void 0,users:[]}),a="users"!==o?f.h({q:i||void 0,organization:t&&t.key,p:s}):Promise.resolve({paging:void 0,groups:[]});return Promise.all([n,a])},this.loadHolders=()=>(this.setState({loading:!0}),this.loadUsersAndGroups().then(e=>{let s=y(e,2),t=s[0],r=s[1];this.mounted&&this.setState({groups:r.groups,groupsPaging:r.paging,loading:!1,users:t.users,usersPaging:t.paging})},this.stopLoading)),this.onLoadMore=()=>{const e=this.state,s=e.usersPaging,t=e.groupsPaging;return this.setState({loading:!0}),this.loadUsersAndGroups(s?s.pageIndex+1:1,t?t.pageIndex+1:1).then(e=>{let s=y(e,2),t=s[0],r=s[1];this.mounted&&this.setState(e=>{let s=e.groups,o=e.users;return{groups:[...s,...r.groups],groupsPaging:r.paging,loading:!1,users:[...o,...t.users],usersPaging:t.paging}})},this.stopLoading)},this.onFilter=e=>{this.setState({filter:e},this.loadHolders)},this.onSearch=e=>{this.setState({query:e},this.loadHolders)},this.addPermissionToGroup=(e,s,t)=>e.map(e=>e.name===s?Object.assign({},e,{permissions:[...e.permissions,t]}):e),this.addPermissionToUser=(e,s,t)=>e.map(e=>e.login===s?Object.assign({},e,{permissions:[...e.permissions,t]}):e),this.removePermissionFromGroup=(e,s,t)=>e.map(e=>e.name===s?Object.assign({},e,{permissions:o()(e.permissions,t)}):e),this.removePermissionFromUser=(e,s,t)=>e.map(e=>e.login===s?Object.assign({},e,{permissions:o()(e.permissions,t)}):e),this.grantPermissionToGroup=(e,s)=>this.mounted?(this.setState(t=>{let r=t.groups;return{groups:this.addPermissionToGroup(r,e,s)}}),f.o({groupName:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let r=t.groups;return{groups:this.removePermissionFromGroup(r,e,s)}})})):Promise.resolve(),this.grantPermissionToUser=(e,s)=>this.mounted?(this.setState(t=>{let r=t.users;return{users:this.addPermissionToUser(r,e,s)}}),f.p({login:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let r=t.users;return{users:this.removePermissionFromUser(r,e,s)}})})):Promise.resolve(),this.revokePermissionFromGroup=(e,s)=>this.mounted?(this.setState(t=>{let r=t.groups;return{groups:this.removePermissionFromGroup(r,e,s)}}),f.t({groupName:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let r=t.groups;return{groups:this.addPermissionToGroup(r,e,s)}})})):Promise.resolve(),this.revokePermissionFromUser=(e,s)=>this.mounted?(this.setState(t=>{let r=t.users;return{users:this.removePermissionFromUser(r,e,s)}}),f.u({login:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let r=t.users;return{users:this.addPermissionToUser(r,e,s)}})})):Promise.resolve(),this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.state={filter:"all",groups:[],loading:!0,query:"",users:[]}}componentDidMount(){this.mounted=!0,this.loadHolders()}componentWillUnmount(){this.mounted=!1}render(){return i.createElement("div",{className:"page page-limited"},i.createElement(P.a,{suggestions:"global_permissions"}),i.createElement(a.a,{title:Object(l.l)("global_permissions.permission")}),i.createElement(p,{loading:this.state.loading,organization:this.props.organization}),i.createElement(v,{filter:this.state.filter,grantPermissionToGroup:this.grantPermissionToGroup,grantPermissionToUser:this.grantPermissionToUser,groups:this.state.groups,groupsPaging:this.state.groupsPaging,loadHolders:this.loadHolders,loading:this.state.loading,onFilter:this.onFilter,onLoadMore:this.onLoadMore,onSearch:this.onSearch,query:this.state.query,revokePermissionFromGroup:this.revokePermissionFromGroup,revokePermissionFromUser:this.revokePermissionFromUser,users:this.state.users,usersPaging:this.state.usersPaging}))}}},384:function(e,s,t){"use strict";t.d(s,"a",function(){return l});var r=t(365),o=t(366),i=t(374),n=t(423),a=t(373);t(393);function l(e){const s=e.children,t=void 0===s?r.createElement(n.a,{fill:a.gray71,size:12}):s,l=e.tagName,p=void 0===l?"div":l;return r.createElement(p,{className:o("help-tooltip",e.className)},r.createElement(i.a,{mouseLeaveDelay:.25,onShow:e.onShow,overlay:e.overlay,placement:e.placement},r.createElement("span",{className:"display-inline-flex-center"},t)))}},389:function(e,s,t){"use strict";t.d(s,"a",function(){return i});var r=t(365),o=t(411);function i(e){let s=e.suggestions;return r.createElement(o.a.Consumer,null,e=>{let t=e.addSuggestions,o=e.removeSuggestions;return r.createElement(n,{addSuggestions:t,removeSuggestions:o,suggestions:s})})}class n extends r.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},393:function(e,s,t){var r=t(394);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};t(369)(r,o);r.locals&&(e.exports=r.locals)},394:function(e,s,t){(e.exports=t(368)(!1)).push([e.i,".help-tooltip{display:inline-flex;align-items:center;vertical-align:middle}.help-toolip-link{display:block;width:12px;height:12px;border:none}",""])},397:function(e,s,t){"use strict";t.d(s,"a",function(){return p});var r=t(365),o=t(366),i=t(375),n=t(0),a=t(376),l=function(e,s){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&s.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)s.indexOf(r[o])<0&&(t[r[o]]=e[r[o]])}return t};function p(e){var s=e.ready,t=void 0===s||s,p=l(e,["ready"]);const u=p.total&&p.total>p.count,g=r.createElement("a",{className:"spacer-left",href:"#",onClick:e=>{e.preventDefault(),e.currentTarget.blur(),p.loadMore&&p.loadMore()}},Object(n.l)("show_more")),m=r.createElement("a",{className:"spacer-left",href:"#",onClick:e=>{e.preventDefault(),e.currentTarget.blur(),p.reload&&p.reload()}},Object(n.l)("reload")),h=o("spacer-top note text-center",{"new-loading":!t},p.className);let d;return p.needReload&&p.reload?d=m:u&&p.loadMore&&(d=g),r.createElement("footer",{className:h},Object(n.m)("x_of_y_shown",Object(a.formatMeasure)(p.count,"INT",null),Object(a.formatMeasure)(p.total,"INT",null)),d,p.loading&&r.createElement(i.a,{className:"text-bottom spacer-left position-absolute"}))}}}]);
//# sourceMappingURL=19.m.72981f09.chunk.js.map
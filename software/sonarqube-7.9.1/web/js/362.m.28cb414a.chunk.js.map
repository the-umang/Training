{"version":3,"sources":["webpack:///./src/main/js/apps/organizations/components/OrganizationAccessContainer.tsx","webpack:///./src/main/js/app/utils/handleRequiredAuthorization.ts"],"names":["__webpack_require__","r","__webpack_exports__","d","OrganizationAccess","hasAdminAccess","OrganizationAdminAccess","react__WEBPACK_IMPORTED_MODULE_0__","react_redux__WEBPACK_IMPORTED_MODULE_1__","_store_rootReducer__WEBPACK_IMPORTED_MODULE_2__","_app_utils_handleRequiredAuthorization__WEBPACK_IMPORTED_MODULE_3__","_helpers_users__WEBPACK_IMPORTED_MODULE_4__","[object Object]","this","checkPermissions","props","hasAccess","Object","children","location","organization","OrganizationAccessContainer","state","ownProps","currentUser","params","organizationKey","_ref","Boolean","actions","admin","assign","handleRequiredAuthorization","_getStore__WEBPACK_IMPORTED_MODULE_0__","_getHistory__WEBPACK_IMPORTED_MODULE_1__","_store_appState__WEBPACK_IMPORTED_MODULE_2__","store","history","returnTo","window","pathname","search","hash","dispatch","replace","query","return_to"],"mappings":"6FAAAA,EAAAC,EAAAC,GAAAF,EAAAG,EAAAD,EAAA,uCAAAE,IAAAJ,EAAAG,EAAAD,EAAA,mCAAAG,IAAAL,EAAAG,EAAAD,EAAA,4CAAAI,IAAA,IAAAC,EAAAP,EAAA,KAAAQ,EAAAR,EAAA,KAAAS,EAAAT,EAAA,KAAAU,EAAAV,EAAA,KAAAW,EAAAX,EAAA,KAuCO,MAAMI,UAA2BG,EAAA,cAAxCK,kCASEC,KAAAC,iBAAmB,KACZD,KAAKE,MAAMC,UAAUH,KAAKE,QAC7BE,OAAAP,EAAA,EAAAO,IAVJL,oBACEC,KAAKC,mBAGPF,qBACEC,KAAKC,mBASPF,SACE,OAAKC,KAAKE,MAAMC,UAAUH,KAAKE,OAGxBR,EAAA,aAAmBM,KAAKE,MAAMG,SAAU,CAC7CC,SAAUN,KAAKE,MAAMI,SACrBC,aAAcP,KAAKE,MAAMK,eAJlB,MASb,MAKMC,EAA8BJ,OAAAT,EAAA,QAAAS,CALZ,CAACK,EAAcC,KAAf,CACtBC,YAAaP,OAAAR,EAAA,eAAAQ,CAAeK,GAC5BF,aAAcH,OAAAR,EAAA,qBAAAQ,CAAqBK,EAAOC,EAASE,OAAOC,mBAGxBT,CAAyBb,GAEtD,SAASC,EAAVsB,GAG+C,IAFnDH,EAEmDG,EAFnDH,YACAJ,EACmDO,EADnDP,aAEA,OAAOQ,QACLX,OAAAN,EAAA,EAAAM,CAAWO,IAAgBJ,GAAgBA,EAAaS,SAAWT,EAAaS,QAAQC,OAIrF,SAASxB,EAAwBS,GACtC,OAAOR,EAAA,cAACc,EAA2BJ,OAAAc,OAAA,CAACf,UAAWX,GAAoBU,uCClFrEf,EAAAG,EAAAD,EAAA,sBAAA8B,IAAA,IAAAC,EAAAjC,EAAA,KAAAkC,EAAAlC,EAAA,KAAAmC,EAAAnC,EAAA,KAuBe,SAASgC,IACtB,MAAMI,EAAQnB,OAAAgB,EAAA,QAAAhB,GACRoB,EAAUpB,OAAAiB,EAAA,EAAAjB,GAEVqB,EAAWC,OAAOpB,SAASqB,SAAWD,OAAOpB,SAASsB,OAASF,OAAOpB,SAASuB,KAErFN,EAAMO,SAAS1B,OAAAkB,EAAA,EAAAlB,IACfoB,EAAQO,QAAQ,CAAEJ,SAAU,gBAAiBK,MAAO,CAAEC,UAAWR","file":"js/362.m.28cb414a.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { RouterState } from 'react-router';\nimport { getCurrentUser, getOrganizationByKey, Store } from '../../../store/rootReducer';\nimport handleRequiredAuthorization from '../../../app/utils/handleRequiredAuthorization';\nimport { isLoggedIn } from '../../../helpers/users';\n\ninterface StateToProps {\n  currentUser: T.CurrentUser;\n  organization?: T.Organization;\n}\n\ninterface OwnProps extends RouterState {\n  children: JSX.Element;\n}\n\ninterface Props extends StateToProps, Pick<OwnProps, 'children' | 'location'> {\n  hasAccess: (props: Props) => boolean;\n}\n\nexport class OrganizationAccess extends React.PureComponent<Props> {\n  componentDidMount() {\n    this.checkPermissions();\n  }\n\n  componentDidUpdate() {\n    this.checkPermissions();\n  }\n\n  checkPermissions = () => {\n    if (!this.props.hasAccess(this.props)) {\n      handleRequiredAuthorization();\n    }\n  };\n\n  render() {\n    if (!this.props.hasAccess(this.props)) {\n      return null;\n    }\n    return React.cloneElement(this.props.children, {\n      location: this.props.location,\n      organization: this.props.organization\n    });\n  }\n}\n\nconst mapStateToProps = (state: Store, ownProps: OwnProps) => ({\n  currentUser: getCurrentUser(state),\n  organization: getOrganizationByKey(state, ownProps.params.organizationKey)\n});\n\nconst OrganizationAccessContainer = connect(mapStateToProps)(OrganizationAccess);\n\nexport function hasAdminAccess({\n  currentUser,\n  organization\n}: Pick<StateToProps, 'currentUser' | 'organization'>) {\n  return Boolean(\n    isLoggedIn(currentUser) && organization && organization.actions && organization.actions.admin\n  );\n}\n\nexport function OrganizationAdminAccess(props: OwnProps) {\n  return <OrganizationAccessContainer hasAccess={hasAdminAccess} {...props} />;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport getStore from './getStore';\nimport getHistory from './getHistory';\nimport { requireAuthorization } from '../../store/appState';\n\nexport default function handleRequiredAuthorization() {\n  const store = getStore();\n  const history = getHistory();\n\n  const returnTo = window.location.pathname + window.location.search + window.location.hash;\n\n  store.dispatch(requireAuthorization());\n  history.replace({ pathname: '/sessions/new', query: { return_to: returnTo } });\n}\n"],"sourceRoot":""}
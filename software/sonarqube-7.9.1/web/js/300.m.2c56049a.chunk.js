(window.webpackJsonp=window.webpackJsonp||[]).push([[300],{1705:function(e,t,n){"use strict";n.r(t);var s=n(365),a=n(381),i=n.n(a),r=n(377),o=n(672),c=n(366),l=n(371),u=n(359),m=n(431),d=n(799),p=n(385),h=n(367),g=n(673),f=n(0);class b extends s.PureComponent{constructor(){super(...arguments),this.handleRevert=()=>{Object(g.a)().then(this.props.refreshPending,()=>{})}}render(){const e=this.props.pending,t=e.installing,n=e.updating,a=e.removing;return t.length||n.length||a.length?s.createElement(p.a,{className:"js-pending",display:"banner",variant:"info"},s.createElement("div",{className:"display-flex-center"},s.createElement("span",{className:"little-spacer-right"},s.createElement(m.a,{message:Object(f.l)("marketplace.instance_needs_to_be_restarted_to")})),[{length:t.length,msg:"marketplace.install_x_plugins"},{length:n.length,msg:"marketplace.update_x_plugins"},{length:a.length,msg:"marketplace.uninstall_x_plugins"}].filter(e=>{return e.length>0}).map((e,t)=>{let n=e.length,a=e.msg;return s.createElement("span",{key:a},t>0&&"; ",s.createElement(u.FormattedMessage,{defaultMessage:Object(f.l)(a),id:a,values:{nb:s.createElement("strong",null,n)}}))}),s.createElement(d.a,{className:"spacer-left",fetchSystemStatus:this.props.fetchSystemStatus,systemStatus:this.props.systemStatus}),s.createElement(h.a,{className:"spacer-left js-cancel-all",onClick:this.handleRevert},Object(f.l)("marketplace.revert")))):null}}var v=n(14);function S(){return s.createElement(p.a,{display:"banner",variant:"info"},s.createElement(u.FormattedMessage,{defaultMessage:Object(f.l)("system.instance_restarting"),id:"system.instance_restarting",values:{instance:Object(v.getInstance)(),link:s.createElement(l.Link,{to:{pathname:"/admin/background_tasks"}},Object(f.l)("background_tasks.page"))}}))}var O=n(718),y=n(388),E=n(391),j=n(660),k=n(373);class C extends s.PureComponent{constructor(){super(...arguments),this.renderExtension=e=>{let t=e.key,n=e.name;return s.createElement("li",{key:t},s.createElement(l.Link,{activeClassName:"active",to:"/admin/extension/".concat(t)},n))}}isSomethingActive(e){const t=window.location.pathname;return e.some(e=>0===t.indexOf(window.baseUrl+e))}isSecurityActive(){return this.isSomethingActive(["/admin/users","/admin/groups","/admin/permissions","/admin/permission_templates"])}isProjectsActive(){return this.isSomethingActive(["/admin/projects_management","/admin/background_tasks"])}isSystemActive(){return this.isSomethingActive(["/admin/system"])}isMarketplace(){return this.isSomethingActive(["/admin/marketplace"])}renderConfigurationTab(){const e=this.props.organizationsEnabled,t=this.props.extensions.filter(e=>"license/support"!==e.key);return s.createElement(y.b,{overlay:s.createElement("ul",{className:"menu"},s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/settings"},Object(f.l)("settings.page"))),s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/settings/encryption"},Object(f.l)("property.category.security.encryption"))),s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/custom_metrics"},Object(f.l)("custom_metrics.page"))),!e&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/webhooks"},Object(f.l)("webhooks.page"))),t.map(this.renderExtension)),tagName:"li"},e=>{let t=e.onToggleClick,n=e.open;return s.createElement("a",{"aria-expanded":n,"aria-haspopup":"true",className:c("dropdown-toggle",{active:n||!this.isSecurityActive()&&!this.isProjectsActive()&&!this.isSystemActive()&&!this.isSomethingActive(["/admin/extension/license/support"])&&!this.isMarketplace()}),href:"#",id:"settings-navigation-configuration",onClick:t},Object(f.l)("sidebar.project_settings"),s.createElement(E.a,{className:"little-spacer-left"}))})}renderProjectsTab(){const e=this.props.organizationsEnabled;return s.createElement(y.b,{overlay:s.createElement("ul",{className:"menu"},!e&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/projects_management"},Object(f.l)("management"))),s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/background_tasks"},Object(f.l)("background_tasks.page")))),tagName:"li"},e=>{let t=e.onToggleClick,n=e.open;return s.createElement("a",{"aria-expanded":n,"aria-haspopup":"true",className:c("dropdown-toggle",{active:n||this.isProjectsActive()}),href:"#",onClick:t},Object(f.l)("sidebar.projects"),s.createElement(E.a,{className:"little-spacer-left"}))})}renderSecurityTab(){const e=this.props.organizationsEnabled;return s.createElement(y.b,{overlay:s.createElement("ul",{className:"menu"},s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/users"},Object(f.l)("users.page"))),!e&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/groups"},Object(f.l)("user_groups.page"))),!e&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/permissions"},Object(f.l)("global_permissions.page"))),!e&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/permission_templates"},Object(f.l)("permission_templates")))),tagName:"li"},e=>{let t=e.onToggleClick,n=e.open;return s.createElement("a",{"aria-expanded":n,"aria-haspopup":"true",className:c("dropdown-toggle",{active:n||this.isSecurityActive()}),href:"#",onClick:t},Object(f.l)("sidebar.security"),s.createElement(E.a,{className:"little-spacer-left"}))})}render(){const e=this.props,t=e.extensions,n=e.pendingPlugins,a=t.find(e=>"license/support"===e.key),i=n.installing.length+n.removing.length+n.updating.length;let r;return"RESTARTING"===this.props.systemStatus?r=s.createElement(S,null):i>0&&(r=s.createElement(b,{fetchSystemStatus:this.props.fetchSystemStatus,pending:n,refreshPending:this.props.fetchPendingPlugins,systemStatus:this.props.systemStatus})),s.createElement(O.a,{height:r?k.contextNavHeightRaw+30:k.contextNavHeightRaw,id:"context-navigation",notif:r},s.createElement("header",{className:"navbar-context-header"},s.createElement("h1",null,Object(f.l)("layout.settings"))),s.createElement(j.a,null,this.renderConfigurationTab(),this.renderSecurityTab(),this.renderProjectsTab(),s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/system"},Object(f.l)("sidebar.system"))),s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/marketplace"},Object(f.l)("marketplace.page"))),a&&s.createElement("li",null,s.createElement(l.IndexLink,{activeClassName:"active",to:"/admin/extension/license/support"},Object(f.l)("support")))))}}C.defaultProps={extensions:[]};var N=n(379),x=n(568),P=n(542),_=n(569),w=n(531);n.d(t,"AdminContainer",function(){return A});class A extends s.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={pendingPlugins:o.b,systemStatus:o.c},this.fetchNavigationSettings=()=>{Object(x.c)().then(e=>this.props.setAdminPages(e.extensions),()=>{})},this.fetchPendingPlugins=()=>{Object(g.e)().then(e=>{this.mounted&&this.setState({pendingPlugins:e})},()=>{})},this.fetchSystemStatus=()=>{Object(w.c)().then(e=>{let t=e.status;this.mounted&&(this.setState({systemStatus:t}),"RESTARTING"===t&&this.waitRestartingDone())},()=>{})},this.waitRestartingDone=()=>{Object(w.h)().then(e=>{let t=e.status;this.mounted&&(this.setState({systemStatus:t}),document.location.reload())},()=>{})}}componentDidMount(){this.mounted=!0,this.props.appState.canAdmin?(this.fetchNavigationSettings(),this.fetchPendingPlugins(),this.fetchSystemStatus()):Object(_.a)()}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.appState,t=e.adminPages,n=e.organizationsEnabled;if(!t)return null;const a=this.state,r=a.pendingPlugins,c=a.systemStatus,l=Object(f.l)("layout.settings");return s.createElement("div",null,s.createElement(i.a,{defaultTitle:l,titleTemplate:"%s - "+l}),s.createElement(C,{extensions:t,fetchPendingPlugins:this.fetchPendingPlugins,fetchSystemStatus:this.fetchSystemStatus,location:this.props.location,organizationsEnabled:n,pendingPlugins:r,systemStatus:c}),s.createElement(o.a.Provider,{value:{fetchSystemStatus:this.fetchSystemStatus,fetchPendingPlugins:this.fetchPendingPlugins,pendingPlugins:r,systemStatus:c}},this.props.children))}}const T={setAdminPages:P.d};t.default=Object(r.connect)(e=>({appState:Object(N.getAppState)(e)}),T)(A)},378:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var s=n(365),a=n(405),i=n(366);function r(e){return s.createElement(a,Object.assign({className:i("modal",{"modal-small":"small"===e.size,"modal-medium":"medium"===e.size,"modal-large":"large"===e.size}),isOpen:!0,overlayClassName:i("modal-overlay",{"modal-no-backdrop":e.noBackdrop})},e))}a.setAppElement("#content")},387:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var s=n(365),a=n(378),i=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&(n[s[a]]=e[s[a]])}return n};class r extends s.Component{constructor(){super(...arguments),this.mounted=!1,this.state={submitting:!1},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})},this.handleCloseClick=e=>{e&&(e.preventDefault(),e.currentTarget.blur()),this.props.onClose()},this.handleFormSubmit=e=>{e.preventDefault(),this.submit()},this.handleSubmitClick=e=>{e&&(e.preventDefault(),e.currentTarget.blur()),this.submit()},this.submit=()=>{const e=this.props.onSubmit();e&&(this.setState({submitting:!0}),e.then(this.stopSubmitting,this.stopSubmitting))}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=this.props,t=e.children,n=e.header,r=e.onClose,o=(e.onSubmit,i(e,["children","header","onClose","onSubmit"]));return s.createElement(a.a,Object.assign({contentLabel:n,onRequestClose:r},o),t({onCloseClick:this.handleCloseClick,onFormSubmit:this.handleFormSubmit,onSubmitClick:this.handleSubmitClick,submitting:this.state.submitting}))}}},396:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var s=n(365),a=n(387),i=n(375),r=n(367),o=n(0);class c extends s.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.handleSubmit=()=>{const e=this.props.onConfirm(this.props.confirmData);return e?e.then(this.props.onClose,()=>{}):void this.props.onClose()},this.renderModalContent=e=>{let t=e.onCloseClick,n=e.onFormSubmit,a=e.submitting;const c=this.props,l=c.children,u=c.confirmButtonText,m=c.confirmDisable,d=c.header,p=c.headerDescription,h=c.isDestructive,g=c.cancelButtonText,f=void 0===g?Object(o.l)("cancel"):g;return s.createElement("form",{onSubmit:n},s.createElement("header",{className:"modal-head"},s.createElement("h2",null,d),p),s.createElement("div",{className:"modal-body"},l),s.createElement("footer",{className:"modal-foot"},s.createElement(i.a,{className:"spacer-right",loading:a}),s.createElement(r.i,{autoFocus:!0,className:h?"button-red":void 0,disabled:a||m},u),s.createElement(r.h,{disabled:a,onClick:t},f)))}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=this.props,t={header:e.header,onClose:e.onClose,noBackdrop:e.noBackdrop,size:e.size};return s.createElement(a.a,Object.assign({onSubmit:this.handleSubmit},t),this.renderModalContent)}}},412:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var s=n(365),a=n(396),i=n(413),r=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&(n[s[a]]=e[s[a]])}return n};class o extends s.PureComponent{constructor(){super(...arguments),this.renderConfirmModal=e=>{let t=e.onClose;const n=this.props,i=(n.children,n.modalBody),o=n.modalHeader,c=n.modalHeaderDescription,l=r(n,["children","modalBody","modalHeader","modalHeaderDescription"]);return s.createElement(a.a,Object.assign({header:o,headerDescription:c,onClose:t},l),i)}}render(){return s.createElement(i.a,{modal:this.renderConfirmModal},this.props.children)}}},413:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var s=n(365);class a extends s.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={modal:!1},this.handleButtonClick=()=>{this.setState({modal:!0})},this.handleFormSubmit=e=>{e&&e.preventDefault(),this.setState({modal:!0})},this.handleCloseModal=()=>{this.mounted&&this.setState({modal:!1})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){return s.createElement(s.Fragment,null,this.props.children({onClick:this.handleButtonClick,onFormSubmit:this.handleFormSubmit}),this.state.modal&&this.props.modal({onClose:this.handleCloseModal}))}}},420:function(e,t,n){var s=n(442),a=1/0,i=1.7976931348623157e308;e.exports=function(e){return e?(e=s(e))===a||e===-a?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},459:function(e,t,n){var s=n(420);e.exports=function(e){var t=s(e),n=t%1;return t==t?n?t-n:t:0}},492:function(e,t){e.exports=function(e,t,n,s){for(var a=e.length,i=n+(s?1:-1);s?i--:++i<a;)if(t(e[i],i,e))return i;return-1}},531:function(e,t,n){"use strict";n.d(t,"g",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return m}),n.d(t,"h",function(){return d});var s=n(4),a=n(383);function i(e){return Object(s.post)("/api/system/change_log_level",{level:e}).catch(a.a)}function r(){return Object(s.getJSON)("/api/system/info").catch(a.a)}function o(){return Object(s.getJSON)("/api/system/status")}function c(){return Object(s.getJSON)("/api/system/upgrades")}function l(){return Object(s.getJSON)("/api/system/db_migration_status")}function u(){return Object(s.postJSON)("/api/system/migrate_db")}function m(){return Object(s.post)("/api/system/restart").catch(a.a)}function d(){return Object(s.requestTryAndRepeatUntil)(o,{max:-1,slowThreshold:-15},e=>{return"UP"===e.status})}},568:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o});var s=n(4),a=n(383);function i(e){return Object(s.getJSON)("/api/navigation/component",e).catch(a.a)}function r(){return Object(s.getJSON)("/api/navigation/marketplace").catch(a.a)}function o(){return Object(s.getJSON)("/api/navigation/settings").catch(a.a)}},569:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var s=n(428),a=n(466),i=n(542);function r(){const e=Object(s.default)(),t=Object(a.a)(),n=window.location.pathname+window.location.search+window.location.hash;e.dispatch(Object(i.c)()),t.replace({pathname:"/sessions/new",query:{return_to:n}})}},672:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var s=n(365);const a={installing:[],removing:[],updating:[]},i="UP",r=s.createContext({fetchSystemStatus:()=>{},fetchPendingPlugins:()=>{},pendingPlugins:a,systemStatus:i});t.a=r},673:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return p}),n.d(t,"d",function(){return h}),n.d(t,"f",function(){return g}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"a",function(){return S});var s=n(674),a=n.n(s),i=n(4),r=n(383),o=n(525);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],s=!0,a=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(s=(r=o.next()).done)&&(n.push(r.value),!t||n.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==o.return||o.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(){return Object(i.getJSON)("/api/plugins/available").catch(r.a)}function u(){return Object(i.getJSON)("/api/plugins/pending").catch(r.a)}function m(e){if(!e)return[];return["COMPATIBLE","REQUIRES_SYSTEM_UPGRADE","DEPS_REQUIRE_SYSTEM_UPGRADE"].map(t=>{const n=a()(e,e=>e.status===t);return n>-1?e[n]:void 0}).filter(o.a)}function d(e,t){if(!t)return e;const n=t.indexOf(e),s=n>0?t.slice(0,n):[];return Object.assign({},e,{previousUpdates:s})}function p(){return Object(i.getJSON)("/api/plugins/installed",{f:"category"}).then(e=>{return e.plugins},r.a)}function h(){return Promise.all([Object(i.getJSON)("/api/plugins/installed",{f:"category"}),Object(i.getJSON)("/api/plugins/updates")]).then(e=>{let t=c(e,2),n=t[0],s=t[1];return n.plugins.map(e=>{const t=s.plugins.find(t=>t.key===e.key);return t?Object.assign({},t,e,{updates:m(t.updates).map(e=>d(e,t.updates))}):e})}).catch(r.a)}function g(){return Promise.all([Object(i.getJSON)("/api/plugins/updates"),Object(i.getJSON)("/api/plugins/installed")]).then(e=>{let t=c(e,2),n=t[0],s=t[1];return n.plugins.map(e=>{const t=m(e.updates).map(t=>d(t,e.updates)),n=s.plugins.find(t=>t.key===e.key);return n?Object.assign({},n,e,{updates:t}):Object.assign({},e,{updates:t})})}).catch(r.a)}function f(e){return Object(i.post)("/api/plugins/install",e).catch(r.a)}function b(e){return Object(i.post)("/api/plugins/uninstall",e).catch(r.a)}function v(e){return Object(i.post)("/api/plugins/update",e).catch(r.a)}function S(){return Object(i.post)("/api/plugins/cancel_all").catch(r.a)}},674:function(e,t,n){var s=n(492),a=n(15),i=n(459),r=Math.max,o=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=i(n),l=n<0?r(c+l,0):o(l,c-1)),s(e,a(t,3),l,!0)}},799:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var s=n(365),a=n(366),i=n(412),r=n(0),o=n(531),c=n(367);class l extends s.PureComponent{constructor(){super(...arguments),this.handleConfirm=()=>Object(o.f)().then(this.props.fetchSystemStatus)}render(){const e=this.props,t=e.className,n=e.systemStatus;return s.createElement(i.a,{confirmButtonText:Object(r.l)("restart"),modalBody:s.createElement(s.Fragment,null,s.createElement("p",{className:"spacer-top spacer-bottom"},Object(r.l)("system.are_you_sure_to_restart")),s.createElement("p",null,Object(r.l)("system.forcing_shutdown_not_recommended"))),modalHeader:Object(r.l)("system.restart_server"),onConfirm:this.handleConfirm},e=>{let i=e.onClick;return s.createElement(c.a,{className:a("button-red",t),disabled:"UP"!==n,onClick:i},"RESTARTING"===n?Object(r.l)("system.restart_in_progress"):Object(r.l)("system.restart_server"))})}}}}]);
//# sourceMappingURL=300.m.2c56049a.chunk.js.map